<%# Form Field Component - Reusable %>
<%# Groups a label, input field, and error message for any form field %>
<%# Usage: render 'shared/form_field', form: form, field_name: :name, field_type: 'text', required: true %>

<div>
  <%# Label %>
  <%= form.label field_name.to_sym, (field_name.to_s.humanize), class: "block antialiased font-sans text-sm font-medium leading-relaxed text-blue-gray-900 mb-2 #{required ? 'after:content-[\'*\'] after:text-red-500 after:ml-1' : ''}" %>
  
  <%# Input Field - Handle different input types %>
  <% field_errors = form.object.present? && form.object.errors[field_name.to_sym].present? ? form.object.errors[field_name.to_sym] : [] %>
  <% field_id = "#{form.object_name}_#{field_name.to_sym}" %>
  <% base_input_classes = "mt-1 w-full rounded-lg border border-gray-300 px-3 py-2 text-sm text-gray-700 placeholder-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-20 #{field_errors.any? ? 'border-red-500 focus:border-red-500 focus:ring-red-500' : ''}" %>
  <% aria_attrs = field_errors.any? ? { 'aria-describedby': "#{field_id}_errors" } : {} %>
  
  <% case field_type.to_s.downcase %>
  <% when 'textarea' %>
    <%= form.text_area field_name.to_sym,
        id: field_id,
        class: base_input_classes,
        required: required || false,
        placeholder: placeholder,
        rows: textarea_rows || 3,
        maxlength: maxlength,
        **aria_attrs %>
  <% when 'select' %>
    <%= form.select field_name.to_sym,
        select_options || [],
        { include_blank: !required },
        {
          id: field_id,
          class: base_input_classes.gsub('placeholder-gray-400', ''),
          required: required || false,
          **aria_attrs
        } %>
  <% when 'date' %>
    <%= form.date_field field_name.to_sym,
        id: field_id,
        class: base_input_classes,
        required: required || false,
        **aria_attrs %>
  <% when 'number' %>
    <%= form.number_field field_name.to_sym,
        id: field_id,
        class: base_input_classes,
        required: required || false,
        **aria_attrs %>
  <% when 'email' %>
    <%= form.email_field field_name.to_sym,
        id: field_id,
        class: base_input_classes,
        required: required || false,
        placeholder: placeholder,
        maxlength: maxlength,
        **aria_attrs %>
  <% when 'password' %>
    <%= form.password_field field_name.to_sym,
        id: field_id,
        class: base_input_classes,
        required: required || false,
        placeholder: placeholder,
        maxlength: maxlength,
        **aria_attrs %>
  <% else %>
    <%# Default to text_field for text, and other standard input types %>
    <%= form.text_field field_name.to_sym,
        id: field_id,
        class: base_input_classes,
        required: required || false,
        placeholder: placeholder,
        maxlength: maxlength,
        **aria_attrs %>
  <% end %>
  
  <%# Error Message (conditionally rendered) %>
  <% if field_errors.any? %>
    <%= render 'shared/error_message', errors: field_errors, field_id: "#{field_id}_errors" %>
  <% end %>
</div>

